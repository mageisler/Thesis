\chapter{Performance of the Track Association \label{sec:TrackAss} }

In this section the performance of the track assignment in terms of efficiencies and purities is studied. This is addressing two different points. First, how well does the approach preserve tracks that are coming from the signal interaction? Second, how well does it subtract tracks that are coming from pileup interactions?\\
The different qualities of the association map presented in Section~\ref{sec:AMWFQD} are compared to each other. Also, a comparison to the results from the current pileup subtraction techniques explained in Section~\ref{sec:IntroCurPST} is discussed.

\section{Filter on Reconstructed Vertices \label{sec:TAFVC}}

Before the work flow of the track association is executed a selection is applied on the reconstructed primary vertices. This filter is comprised of the following criteria:
\begin{itemize}
    \item $ \left| z_{vertex} \right| \leq 24\cm$,
    \item $ \left| \rho_{vertex} \right| \leq 2\cm$,
    \item $\chi^{2}$ of the vertex fit needs to be greater than 0,
    \item the number of degrees of freedom of the vertex must be greater than 4,
    \item the number of tracks used for the fit should be greater than 0.
\end{itemize}
Since the number of degrees of freedom is connected to the number of tracks some of these cuts are redundant. The main point of these rather soft cuts is to reject those vertices that the fit failed to reconstruct properly or which are far away from the nominal interaction region.

\section{Filter on Simulated and Reconstructed Tracks \label{sec:TAFSRT}}

For the following studies, the tracks that are analyzed need to be defined. Two filters are set, one on the reconstructed and one on the simulated tracks, respectively. \\
The criteria a reconstructed track needs to fulfill are shown in Table~\ref{tab:TARecoTrackFilter}. The cuts are mainly very soft to analyze most of the reconstructed tracks. For the distribution as a function of the minimum transverse momentum the minimum \pt{} is modified to $0.1\GeV$.

\input{RecoTrackSelectionTable}

Next, a filter on the simulated track collection is applied. The individual selection criteria can be found in Table~\ref{tab:TASimTrackFilter}. Again, for plots as a function of the transverse momentum the cut value is lowered to a minimum \pt{} of $0.1\GeV$. The transverse impact parameter is the minimum distance of the track to the beam axis in the $x$-$y$ plane while the longitudinal is the minimum distance of the track to the nominal point of source in the center of the detector. Both values are chosen in a way that the whole tracker volume is covered.

\input{SimTrackSelectionTable}

\section{Comparison of the Different Qualities \label{sec:TASEFRDQ}}

The results presented in this section are based on the same data sample used for the studies in Chapter~\ref{sec:AssMap}, containing simulated $\Zz\rightarrow\MM$ decays and at least one additional jet from the initial state. The center-of-mass energy is 8\TeV and 20 underlying pileup interactions are simulated on average as well as out-of-time pileup. \\
As explained in Section~\ref{sec:AMWFFA} there are three different kinds of maps, depending on the chosen variant for step 3 while step 1 and 2 are always the same. All three different options of the step 3 are analyzed in the following.

\subsection{Signal Efficiency and Purity \label{sec:TASEFR}}

Signal efficiency and purity have already been defined in Section~\ref{sec:AMWFTW}. While the efficiency as defined in Equation~\eqnref{eq:Efficiency} is kept, the purity as in Equation~\eqnref{eq:Purity} is slightly modified to account only for association tasks:
\begin{equation}
    \textrm{p} = \frac{ \textrm{reco. track assigned to the signal vertex \textbf{and matched to a sim. signal track} } }{ \textrm{reco. track assigned to the signal vertex and matched to any sim. track} }.
    \label{eq:AssPurity}
\end{equation}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_1_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_1_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_1_npu}
    \caption[Efficiencies, purities and their product of the different qualities of the association map with associating the track always to the first vertex in step 3]{The efficiencies, purities and the product of both of the different qualities for associating the track always to the first vertex in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQ1Signal}}
\end{figure}

With this, the performance of the different pileup subtraction techniques concerning how well they preserve simulated signal tracks in the subtraction is evaluated. The efficiency is based on simulated tracks and represents the fraction of how many simulated signal tracks that are reconstructed are correctly associated to the signal vertex. The purity on the other hand is based on reconstructed tracks and represents the fraction of reconstructed tracks that are also simulated as signal and additionally correctly treated as coming from the signal vertex. For both fractions a value of $100\,\%$ is the goal and means a perfect pileup subtraction.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_3_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_3_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_3_npu}
    \caption[Efficiencies, purities and their product of the different qualities of the association map with associating the track to the closest vertex in three dimensions in step 3]{The efficiencies, purities and the product of both of the different qualities for associating the track to the closest vertex in three dimensions in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQ3Signal}}
\end{figure}

First, the results are shown for cases where the track is always associated to the first vertex of the vertex collection in step 3. The distributions of the efficiencies and purities and the product of both can be found in Fig.~\ref{plot:TASEFRDQ1Signal}. In Section~\ref{sec:AMWFQD} the quality of the association has been defined based on the purity. The reason why the purities shown here are better than the values of the categorization is due to the small modification of the purity itself and also due to the filter applied to the tracks. Especially the cut on the transverse momentum has a large impact on the purity.

In general it can be said that for high transverse momenta ($\pt{}\gtrsim{}10\GeV{}$) the association works very well for all qualities. The greatest loss of efficiency and purity is found in the low momentum region. In Table~\ref{tab:TAQualComp} the resulting averaged values are shown for all qualities. Quality 6, which can only be reached from the association based on the track weight, has an averaged purity of around $93\,\%$ but an efficiency of only about $20\,\%$. This efficiency is constant with respect to the number of pileup interactions and increases with the transverse momentum. The former is very important to allow for same physics results at higher luminosities. Comparing the barrel with the endcap region a better efficiency by around $10\,\%$ in the central region is evident. This difference is larger at quality 5 and smaller at all other qualities. The dip in the central region of quality 6 is in agreement with the dip seen in Figure~\ref{plot:AMTrackStepFrac}. Tracks with a pseudorapidity around 0 are not as frequently used for the primary vertex fit as tracks with a higher $\eta{}$. For high momenta an efficiency of about $90\,\%$ can be reached. \\
For quality 5 the efficiency reaches almost $100\,\%$ for transverse momenta greater than 20\GeV. Also the averaged efficiency increases to about $80\,\%$  while the purity decreases only slightly below $90\,\%$. For quality 4 experiences barely change. Quality 3, which is the lowest quality of iteration 1, leads to an averaged purity of $44\,\%$ and an efficiency of $95\,\%$. In this quality step the purity decreases dramatically. This is due to the fact that all tracks that could not be matched to a primary or a secondary vertex are always associated to the first vertex. For the first time, a dependence on the number of pileup interactions is visible. This dependence is even greater for associations with quality 1, which are all associations after iteration 2. Here, the efficiency is $100\,\%$, which basically means that the simulated signal vertex is reconstructed as the first or the second vertex. On the other hand the purity of this quality class is very poor ($18\,\%$). Iteration 3 does not change anything.

Figure~\ref{plot:TASEFRDQ3Signal} shows the results for associating the track to the closest vertex in three dimensions in step 3. The resulting averaged values are shown in Table~\ref{tab:TAQualComp} for all qualities. The results for qualities six and five have already been discussed. No great improvement or degradation on quality four is observed. For both, purity and efficiency, the averaged values differ from quality 5 in the range of $3\--{}5\,\%$. The difference to quality 3 is even smaller. This is due to the fact that only a small amount of associations obtain this quality if the track is associated to the closest vertex in all three dimensions during step 3. After a possible second association of each track the efficiency reaches almost $90\,\%$ while the purity stays comparably high at $68\,\%$. The intermediate quality class 2 leads to a worse efficiency ($87\,\%$) but the purity remains in the order of $85\,\%$. Associating the track to a third vertex then increases the efficiency to about $91\,\%$ while the purity drops to about $56\,\%$. Comparing these results to the performance of associating the track always to the first vertex it can be said that the purity is higher for tracks with a low transverse momentum ($\pt{}\lesssim10\GeV$) and for events with a high number of pileup interactions ($\textrm{npu}\gtrsim30$).

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Z_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Z_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Z_npu}
    \caption[Efficiencies, purities and their product of the different qualities of the association map with associating the track to the closest vertex in z only in step 3]{The efficiencies, purities and the product of both of the different qualities for associating the track to the closest vertex in z only in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQZSignal}}
\end{figure}


Finally, the results are shown for associating the track to the closest vertex in z only during step 3. The distributions of the efficiencies and purities can be found in Fig.~\ref{plot:TASEFRDQZSignal}. In Table~\ref{tab:TAQualComp} the averaged values are shown for all qualities. The resulting efficiencies and purities for this option do not differ much from associating the track to the closest vertex in all three dimension during step 3. Therefore, the discussion given earlier is also valid here.

\input{QualityComparisonTable}
\clearpage{}

\subsection{Pileup Efficiency and Purity \label{sec:TAPUEFR}}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_1_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_1_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_1_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_1_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_1_npu}
    \caption[Pileup efficiencies, purities and their product of the different qualities of the association map with associating the track always to the first vertex in step 3]{The pileup efficiencies, purities and the product of both of the different qualities for associating the track always to the first vertex in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQ1Pileup}}
\end{figure}

In this part the performance of the different approaches is analyzed from a different perspective. Here, the main point is how well the simulated pileup tracks are subtracted from the initial track collection. Therefore, two new fractions are defined. First, an efficiency indicating how many of the simulated pileup tracks that are reconstructed are correctly subtracted from the initial track collection.
\begin{equation}
    \varepsilon_{pu} = \frac{\textrm{simulated as pileup track and reconstructed \textbf{and assigned to pileup vertex}}}{\textrm{simulated as pileup track and reconstructed}}.
    \label{eq:PUEfficiency}
\end{equation}
Next, a purity indicating how many of the reconstructed pileup tracks that are matched to a simulated track are correctly removed from the initial track collection is defined
\begin{equation}
    \textrm{p}_{pu} = \frac{\textrm{reco. track assigned to a pileup vertex \textbf{and matched to a sim. pileup track}}}{\textrm{reco. track assigned to a pileup vertex and matched to any sim. track}}.
    \label{eq:PUPurity}
\end{equation}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_3_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_3_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_3_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_3_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_3_npu}
    \caption[Pileup efficiencies, purities and their product of the different qualities of the association map with associating the track to the closest vertex in three dimensions in step 3]{The pileup efficiencies, purities and the product of both of the different qualities of the association map with associating the track to the closest vertex in three dimensions in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQ3Pileup}}
\end{figure}

The pileup purities and efficiencies for the three techniques of step 3 can be seen in Figs.~\ref{plot:TASEFRDQ1Pileup} to~\ref{plot:TASEFRDQZPileup}. The averaged values can be found in Table~\ref{tab:TAQualComp}, too. Overall, due to the high amount of pileup interactions and therefore pileup tracks, in most cases about $90\,\%$ of the subtracted tracks are correctly identified as pileup. For tracks with a high transverse momentum the pileup purity is low since only a few pileup tracks have a high \pt. Therefore, a wrong subtraction of a signal track has a large effect and leads to a low pileup purity. The same argument holds for events with a low number of pileup interactions. Only executing multiple iterations and associating the track to more than one vertex with associating it always to the first vertex as a technique in step 3 leads to significantly worse results compared to the two other techniques. While for quality 2, both, pileup purity and efficiency, stay high, both values drop to zero for quality 1 and 0. This is because using this technique during step 3 after two associations all tracks are considered as coming from the signal primary vertex. For the pileup efficiency a similar picture is drawn.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Z_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Z_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Z_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Z_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Z_npu}
    \caption[Pileup efficiencies, purities and their product of the different qualities of the association map with associating the track to the closest vertex in z only in step 3]{The pileup efficiencies, purities and the product of both of the different qualities of the association map with associating the track to the closest vertex in z only in step 3. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TASEFRDQZPileup}}
\end{figure}

The two other options for step 3 lead to a pileup efficiency between $84\,\%$ and $100\,\%$ for the different qualities. After one association, still about $97\,\%$ of the simulated pileup tracks are also considered as pileup after reconstruction. After each following iteration this value decreases by about $6\,\%$.

To define a default configuration of the association map the results after iteration 1 are compared. To that end, the performance only in terms of signal efficiency and purity are taken into account. Of course, the efficiency is highest when the track is always associated to the first vertex in step 3. On the other hand, the purity is about $40\,\%$ worse with respect to the other two options. Since the difference in efficiency is comparably small with $9\,\%$, one of the other techniques is chosen. Looking for the closest vertex only along the $z$ axis has a slightly better purity while all other results are exactly the same as shown in Table~\ref{tab:TAQualComp}.  Therefore, in the following plots and comparisons only this version is shown. Plots illustrating a comparison of these three options for the qualities 4 to 0 can be found in the Appendix~\ref{sec:TrackAss_App}.

\section{Comparison to the Other Approaches \label{sec:TASEFRDA}}

Now, the results of the default configuration of the association map are compared to the performance of the other pileup subtraction techniques explained in Section~\ref{sec:IntroCurPST}. As a reference it is also shown what happens if no cleaning is executed. As explained, the other techniques have different methods for charged hadrons with respect to all other tracks. Therefore, also an individual validation of different particle types is presented. \\
For these studies not only the simulated $\Zz\rightarrow\MM$ data sample is used. For electrons simulated $\Zz\rightarrow\EE$ events are used while for charged hadrons \ttbar events are investigated.

\subsection{All Charged Particles \label{sec:TASEFRDACP}}

\subsubsection{$\Zz\rightarrow\MM$ \label{sec:TASEFRDACPZMM}}
In the first part, it is done for the standard $\Zz\rightarrow\MM$ data sample. In this section all tracks are taken into account, for the results for muons only see Section~\ref{sec:TASEFRDAM}. As can be seen in Figs.~\ref{plot:TACOAACPZMMSignal} and~\ref{plot:TACOAACPZMMPileup} there are big differences in the four approaches in terms of purity. The averaged values can be found in Table~\ref{tab:TAAppCompATZMM}. Applying no pileup cleaning leads to a purity below $20\,\%$ while the Jet/MET approach leads to about $45\,\%$. The new approach based on the association map leads to results very similar to the approach of the Muon/Egamma group at about $86\,\%$.

\input{AllTracksComparisonTableZMM}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Efficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Efficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Efficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Purity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Purity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_Purity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_EfficiencyPurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_EfficiencyPurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_EfficiencyPurity_AllTracks_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\MM$ events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\MM$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPZMMSignal}}
\end{figure}

In more detail, all approaches reach a purity of nearly $100\,\%$ for tracks with a \pt greater than 10\GeV. Below this value the various approaches differ strongly. The association map and the Muon/Egamma approach stay at a value of about $80\,\%$ while the other two drop below $30\,\%$. A similar behavior can be seen in events with a high number of pileup interactions. Considering the efficiency, the different approaches lie between $100\,\%$ for no pileup cleaning and $84\,\%$ for the Muon/Egamma approach. Here, the difference is not as big as for the purity. Again, all approaches reach nearly $100\,\%$ for tracks with a \pt greater than 10\GeV. In terms of the product of efficiency and purity the association map leads to the best results. For tracks with a very low \pt{} the advance of the performance of the association map is clearly visible. The benefit of this could be an improvement of the reconstruction of jets with a low transverses momentum.\\
Regarding their power in subtracting pileup tracks all approaches except for applying no cleaning end up with a pileup purity of around $97\,\%$. With respect to the pileup efficiency the Jet/MET approach falls below the other two approaches by around $20\,\%$.\\
Taking all these four values into account it can be concluded that the association map leads to better results than the other ones. Moreover, with the association map an efficiency comparable to the Jet/MET approach can be reached using three associations. Even then the purity of the association map is $10\,\%$ higher compared to the Jet/MET approach.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUpurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUpurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUpurity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiencypurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiencypurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZMM_PUefficiencypurity_AllTracks_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\MM$ events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\MM$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPZMMPileup}}
\end{figure}

\subsubsection{$\Zz\rightarrow\EE$ \label{sec:TASEFRDACPZEE}}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Efficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Efficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Efficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Purity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Purity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_Purity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_EfficiencyPurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_EfficiencyPurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_EfficiencyPurity_AllTracks_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\EE$ events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\EE$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPZEESignal}}
\end{figure}

As a next test, the analysis is applied to a data sample with simulated \Zz decays into \EE. The number of additional pileup events is about 20 and out-of-time pileup is added, like before. In Figs.~\ref{plot:TACOAACPZEESignal} and~\ref{plot:TACOAACPZEEPileup} the different distributions of the purities and efficiencies are shown. Compared to the results of the $\Zz\rightarrow\MM$ data sample all results are a bit worse. Applying no pileup subtraction leads to a purity of only about $15\,\%$. Again, considering the three pileup subtraction techniques, the association map leads to similar results as the Muon/Egamma approach. The Jet/MET approach leads to a $10\,\%$ better efficiency while the purity is significantly worse.\\
In terms of subtracting pileup the purity of all three approaches is in the same order of magnitude while the pileup efficiency of the Jet/MET approach is $20\,\%$ worse than the other two. Comparing the association map with the Muon/Egamma approach it can be observed that the efficiency as well as the purity are higher by up to $3\,\%$. The greatest difference between these two approaches can be seen in the endcap region or for tracks with a low \pt. For very low \pt the association map is even better than the Jet/MET one. This may be due to the fact that for tracks with a very low \pt the uncertainty of the tracks $d_{Z}$ is rather high (see Section~\ref{sec:LHCCMSPaVR}). Therefore, such tracks can be rejected by the selection criteria of the Jet/MET technique as presented in Section~\ref{sec:IntroCurPST}. Comparing again the association map to Muon/Egamma it can be observed that only the pileup efficiency is a bit worse. At the other three fractions the association map leads to better results.  All these results are summarized in Table~\ref{tab:TAAppCompATZEE}.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUpurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUpurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUpurity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiencypurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiencypurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_ZEE_PUefficiencypurity_AllTracks_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\EE$ events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated $\Zz\rightarrow\EE$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPZEEPileup}}
\end{figure}

\input{AllTracksComparisonTableZEE}

\subsubsection{Top-Pair Production \label{sec:TASEFRDACPTT}}
Finally, the analysis is also applied to a data sample with a rather high track multiplicity. Simulated \ttbar events with at least two simulated jets are chosen. The resulting purities and efficiencies can be seen in Figs.~\ref{plot:TACOAACPTTSignal} and~\ref{plot:TACOAACPTTPileup}. The corresponding averaged values are given in Table~\ref{tab:TAAppCompATTT}. Overall, the values are better compared to the samples with the simulated \Zz decays. In particular, the purity is much better, which is because of the higher number of signal tracks. Consequently, a constant number of pileup tracks, which are wrongly considered as signal tracks, have a lower effect on the purity. Applying no pileup cleaning leads to a purity of about $41\,\%$. The other three approaches are now much closer than for the other samples. In terms of efficiency the Jet/MET approach is about $5\,\%$ better than the association map and about $10\,\%$ better than the Muon/Egamma approach. Again, for tracks with a very low \pt the association map leads to the best results. The difference between the association map and Muon/Egamma is visible over the whole $\eta$ range. \\
The purity of the Jet/MET approach is about $25\,\%$ worse with respect to the other two. These reach a purity of almost $100\,\%$. This may come from the high number of signal tracks caused by the quark-gluon jets. Also, for the pileup efficiency the Muon/Egamma and the association map reach almost $100\,\%$ while the Jet/MET approach is a bit lower. For the pileup purity all approaches are in the range between $90\,\%$ and $95\,\%$.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Efficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Efficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Efficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Purity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Purity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_Purity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_EfficiencyPurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_EfficiencyPurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_EfficiencyPurity_AllTracks_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated \ttbar events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated \ttbar events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPTTSignal}}
\end{figure}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiency_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiency_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiency_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUpurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUpurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUpurity_AllTracks_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiencypurity_AllTracks_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiencypurity_AllTracks_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_TT_PUefficiencypurity_AllTracks_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated \ttbar events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated \ttbar events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAACPTTPileup}}
\end{figure}

\input{AllTracksComparisonTableTT}

\clearpage{}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_ChargedHadrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_ChargedHadrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_ChargedHadrons_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated charged hadrons from \ttbar events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated charged hadrons from \ttbar events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOACHSignal}}
\end{figure}

\subsection{Charged Hadrons \label{sec:TASEFRDACH}}

In this part, the analysis runs only on the reconstructed charged hadrons to study the performance of their association. The data sample used for this is the \ttbar sample. The resulting purities and efficiencies are shown in Figs.~\ref{plot:TACOACHSignal} and~\ref{plot:TACOACHPileup}.  The corresponding values are summarized in Table~\ref{tab:TAAppCompCH}. As already seen for all tracks from the \ttbar sample, all values of efficiency and purity are comparatively high. The gap between the Jet/MET approach and the other two in terms of efficiency is in the order of $10\,\%$ while it is about $25\,\%$ in terms of purity. The main difference is below 1\GeV for the tracks \pt or at a high number of underlying pileup interactions. Comparing only the association map and the Muon/Egamma approach the association map is either better or leads to the same results. \\
Considering the combination of the pileup efficiency and purity an interesting feature can be seen at around 4\GeV{}. While for tracks with a lower \pt{} the association map leads to better results, for tracks with a higher \pt{} the Jet/MET approach leads to the best performance. This feature is because of the pileup purity and is also visible for the other studies but not so significant. While for the other studies the Jet/MET approach leads to similar results as the association map for charged hadrons only the former is significantly better. The reason for this is that the Jet/MET approach subtracts less tracks than the association map. Additionally, only a few charged hadrons from pileup vertices have a large \pt{}. Thus, the pileup purity of the Jet/MET approach is better than that from the association map.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_ChargedHadrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_ChargedHadrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_ChargedHadrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_ChargedHadrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_ChargedHadrons_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated charged hadrons from \ttbar events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated charged hadrons from \ttbar events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOACHPileup}}
\end{figure}

\input{ChargedHadronsComparisonTable}

\subsection{Muons \label{sec:TASEFRDAM}}

Next, only reconstructed muons are taken into account to study the performance of their association. The data sample used  for this is the $\Zz\rightarrow\MM$ sample. The resulting purities and efficiencies are shown in Figs.~\ref{plot:TACOAMuSignal} and~\ref{plot:TACOAMuPileup}. Only a small amount of muons are coming from simulated pileup vertices. Especially in the barrel region and in the high transverse momentum region very few muons are simulated. Hence, in these regions the uncertainties visible in Fig.~\ref{plot:TACOAMuPileup} are large. The low \pt region is empty. Due to the fact that the Jet/MET and the Muon/Egamma approach apply the same filters for muons the same results are obtained. Furthermore, also the association map leads to very similar results for pileup purity and efficiency. The same holds for signal efficiency and purity. All obtained values for efficiencies are greater than $98\,\%$, the values for purity even above $99\,\%$.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Muons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Muons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Muons_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated muons from $\Zz\rightarrow\MM$ events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated muons from $\Zz\rightarrow\MM$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAMuSignal}}
\end{figure}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Muons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Muons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Muons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Muons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Muons_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated muons from $\Zz\rightarrow\MM$ events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated muons from $\Zz\rightarrow\MM$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAMuPileup}}
\end{figure}

\input{MuonComparisonTable}

\clearpage
\subsection{Electrons \label{sec:TASEFRDAE} }

Finally, only the reconstructed electrons from simulated $\Zz\rightarrow\EE$ events are studied. As already mentioned in the analysis for the muons, also here, only few electrons are simulated as pileup tracks. Therefore, the results shown in Figs.~\ref{plot:TACOAElSignal} and~\ref{plot:TACOAElPileup} have large uncertainties or the histograms have only few entries. The averaged values of the purities and efficiencies are summarized in Table~\ref{tab:TAAppCompElec}. Again, the Jet/MET and Muon/Egamma approach lead to the same results due to the same treatment of reconstructed electrons. Also the association map leads to very similar results in all regards. It is only slightly worse in the efficiency and slightly better in purity. The largest difference can be seen in the pileup efficiency. Here, the association map is almost $5\,\%$ better than the other two. In pileup purity all approaches lead to similar results.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Efficiency_Electrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_Purity_Electrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_EfficiencyPurity_Electrons_npu}
    \caption[Efficiencies, purities and their product of the different pileup subtraction techniques based on simulated electrons from $\Zz\rightarrow\EE$ events]{The efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated electrons from $\Zz\rightarrow\EE$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAElSignal}}
\end{figure}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiency_Electrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUpurity_Electrons_npu}
    \\
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Electrons_eta}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Electrons_pt}
    \includegraphics[width=0.325\textwidth]{TV/TrackValidator_PUefficiencypurity_Electrons_npu}
    \caption[Pileup efficiencies, purities and their product of the different pileup subtraction techniques based on simulated electrons from $\Zz\rightarrow\EE$ events]{The pileup efficiencies, purities and the product of both of the different pileup subtraction techniques based on simulated electrons from $\Zz\rightarrow\EE$ events. The distributions are shown as a function of the pseudorapidity $\eta$ (left hand plots), transverse momentum (middle plots) and the number of pileup interactions (right hand plots). \label{plot:TACOAElPileup}}
\end{figure}

\input{ElectronComparisonTable}

\subsection{Conclusion \label{sec:TASEFRDAC}}

In summary, in most cases the association map leads to the best performance regarding the combination of efficiency and purity. Only for tracks with a high \pt{} applying no pileup subtraction leads to better results. For instance, for charged hadrons for tracks with a \pt{} greater than 10\GeV{} this difference is in the order of $5\,\%$. Thus, for these particles the performance of applying no pileup subtraction is better in terms of pileup efficiency and purity for high \pt{}, too. For all other cases the association map leads to the best results regarding the performance in subtracting pileup tracks. \\
In order to reach a better efficiency the track can be associated to two or three vertices. In doing so the gap to the Jet/MET approach in terms of efficiency is decreased to about $3\--1\,\%$ while the purity remains better by about $20\--10\,\%$, respectively. Hence, in terms of efficiency alone doing multiple associations per tracks leads to the best performance. In terms of the combination of efficiency and purity one iteration of the association map leads to the best results. \\
As for most analyses, a common method is desired for all kind of objects, it is proposed to use the association map with one or two iterations globally for future analyses.

