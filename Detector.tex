\chapter{LHC and CMS \label{sec:LHCCMS}}

\section{Large Hadron Collider \label{LHCCMSLHC}}

The Large Hadron Collider (LHC) is a particle collider located at CERN close to Geneva at the French-Swiss border. It is a ring accelerator built on average 100\m{} underground with a circumference of about 27\km{}. The tunnel in which the LHC is placed was already built for the previous accelerator LEP, an electron-positron collider. A sketch of the LHC is shown in Fig.~\ref{plot:LCHSketch}. Furthermore, the SPS as one of the pre-accelerators can be seen. From this accelerator the protons are injected into the LHC with an energy of 450\GeV{}. The design energy of the LHC itself is 7\TeV{} per proton leading to center-of-mass energy of 14\TeV{}. During the first runtime from 2010 until 2012, the LHC ran first with an energy of 3.5\TeV{} per beam, which was increased to 4\TeV{} for the last year. Additionally, at the end of every year, the LHC accelerates lead nuclei. Hence, also protons and lead nuclei or only lead nuclei can be brought to collision. \\
To bend the accelerated hadrons around 1200 superconducting dipole magnets made of Nb-Ti are used. The advanced technology of Rutherford cables (\cite{RuthCables1} and \cite{RuthCables2}) allows a magnetic field above 8\unit{T}. This requires a cooling down to temperatures below 2\K{} using liquid helium. To focus the particle bunches in one direction magnets of higher order, e.g. quadrupole magnets, are used. The acceleration itself is done with superconducting cavities made of copper with sputtered niobium. These are cooled down as well. In the center of all these components the beam pipe is located. At each interaction point the diameter of this beam pipe is reduced to about 6\cm{}. Around these interaction points the detectors are built. All this and further information about the LHC can be found in~\citen{Bruning:782076}.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.65\textwidth]{Detector/Sketch_LHC}
  \caption[Sketch of the LHC]{A sketch of the LHC and the four experiments as they are located at the French-Swiss border taken from~\cite{Team:40525}. \label{plot:LCHSketch}}
\end{figure}

Also shown in Fig.~\ref{plot:LCHSketch} are the four main experiments located around the ring. These are:
\begin{itemize}
\item{ALICE}: \textbf{A} \textbf{L}arge \textbf{I}on \textbf{C}ollider \textbf{E}xperiment, an experiment built to study the quark-gluon-plasma, which is expected to be produced in lead-lead collisions. With this the conditions shortly after the big bang are reproduced. More information about the detector can be found in~\citen{ALICETDR}.
\item{ATLAS}: \textbf{A} \textbf{T}oroidal \textbf{L}HC \textbf{A}pparatu\textbf{S}, which is one of the two multi purpose experiments. The cylindrical detector with a length of 46\m{} and a diameter of 25\m{} is the largest of the four LHC detectors. For more information see~\citen{ATLASTDR1} and~\citen{ATLASTDR2}.
\item{CMS}: \textbf{C}ompact \textbf{M}uon \textbf{S}olenoid, which is the other multi purpose experiment. Compared to the ATLAS detector it is smaller but has a much higher weight. It will be described in more detail later.
\item{LHCb}: \textbf{L}arge \textbf{H}adron \textbf{C}ollider \textbf{b}eauty, which specializes in the study of the bottom (beauty) quark. For this, the innermost layer of the detector is very close to the interaction region of the protons. Furthermore, the detector has an asymmetrical design. More information can be found in~\citen{LHCb:630827}.
\end{itemize}


\subsection{Luminosity and Proton-Proton Interactions \label{sec:IntroLumiPPI}}

One key parameter of the LHC is the delivered instantaneous luminosity \lumi{}. It depends only on machine parameters and can be described as follows
\begin{equation}
\mathcal{L} = \frac{N_{b}^{2}n_{b}f_{rev}\gamma{}_{r}}{4\pi\epsilon{}_{n}\beta^{^\ast}}F,
\label{eq:Luminosity}
\end{equation}
where
\begin{itemize}
\item{$N_{b}$} is the number of particles per bunch, design value is $1.15 \times 10^{11}$
\item{$n_{b}$} is the number of bunches per beam, design value is 2808, during the first run time half that value was achieved
\item{$f_{rev}$} is the revolution frequency, that is in the order of 14 - 15\unit{kHz}
\item{$\gamma_{r}$} is the relativistic gamma factor
\item{$\epsilon{}_{n}$} is the normalized transverse beam emittance, design value is $3.75\,\mum{}\rad$, during the first run time it was around $2.4\,\mum{}\rad$
\item{$\beta^{^\ast}$} is the amplitude function around the collision point, it is in the order of 60\cm{}
\item{$F$} is the geometric luminosity reduction factor arising from the crossing angle of the two colliding proton bunches, design value is 0.836 at a crossing angle of 285\murad{}.
\end{itemize}

Putting all these values together the design luminosity is around \LHigh{} for proton-proton runs. This can be translated into 10\hertzpernbarn{}. As shown in Fig.~\ref{plot:IntroInstLumi}, during the first run period, an instantaneous luminosity greater than 7\hertzpernbarn{} was reached.

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.55\textwidth]{Intro/peak_lumi_per_day_pp_2012}
  \caption[Instantaneous luminosity at CMS]{The instantaneous luminosity as delivered to CMS by the LHC accelerator during the proton-proton run period in 2012. Taken from~\cite{CMS-Lumi-Public-Webpage} \label{plot:IntroInstLumi}}
\end{figure}

To get  a more suitable parameter this instantaneous luminosity needs to be translated into proton-proton interactions per bunch crossing. The total cross section for proton-proton interactions is taken from Fig.~\ref{plot:IntroTotalCross}. At a center-of-mass energy of 8\TeV it is assumed to be approximately 90\mb. Together with the bunch spacing of 50\ns one finds for the number of interactions $n_{int}$ per bunch crossing:
\begin{eqnarray}
n_{int} & \approx & 7\hertzpernbarn \cdot 90\mb \cdot 50\ns \nonumber \\
 & \approx & 31.5 \nonumber.
\end{eqnarray}

Hence, the expected number of proton-proton interactions per bunch crossing during the first run period of the LHC is expected to be in the order of 30. In Fig~\ref{plot:IntroCrossSections} the cross sections for several physics processes is illustrated. As shown, the gap between the total cross section and the cross section for the production of a b quark is about 3 orders of magnitude. Hence, only about 1\permil{} of the proton-proton interactions is of physical interest. These interesting interactions are named signal processes. Furthermore, the probabilty of two signal interactions in one bunch crossing is very low. The additional 30 interactions per bunch crossing are mostly of no interest and are often referred to as pileup.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.7\textwidth]{Intro/ppXsection}
    \caption[Total and elastic cross section for pp interactions]{The total and elastic cross section for proton-proton collisions as a function of the center-of-mass energy. Taken from reference~\citen{Beringer:1900zz}.\label{plot:IntroTotalCross}}
\end{figure}

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/LHCCrossSections}
    \caption[Cross sections for different physics processes]{The cross section specific physics processes as a function of the center-of-mass energy $\sqrt{s}$. For $\sqrt{s}<4\TeV{}$ it is shown for proton-antiproton collisions as produced at the Tevatron. For higher energies for proton-proton collision at the LHC. The dotted lines represent the design center-of-mass energies at the Tevatron (1.96\TeV{}) and the LHC (14\TeV{}). Taken from reference~\citen{Jenni:616089}.\label{plot:IntroCrossSections}}
\end{figure}

\section{Compact Muon Solenoid Experiment \label{LHCCMSCMS}}

\subsection{Coordinate System \label{LCHCMSCoordSys}}

At the CMS experiment the coordinate system is defined as follows. The point of origin is right in the middle of the detector where the proton bunches are supposed to collide. The $x$ axis points towards the center of the LHC ring while the $y$ axis is oriented vertically upwards. Finally, the $z$ axis is parallel to the beam axis going counterclockwise. Based on this two angles are defined.
\begin{itemize}
    \item{$\phi{}$} is the azimuth angle. It is defined as the angle between the $x$ axis and the projection of a vector on the $x$-$y$ plane. An angle of $\phi{} = 0$ describes the positive $x$ axis.
    \item{$\theta{}$} is the polar angle. It is defined as the angle between the $z$ axis and the vector. An angle of $\theta{} = 0$ describes the positive $z$ axis. Usually the so-called pseudorapidity $\eta{}$ is used instead of the angle $\theta$. It is defined as
    \begin{equation}
        \eta{} = \textrm{-}\,{}\textrm{ln} \left( \textrm{tan}\,{}\frac{\theta{}}{2}\right).
        \label{eq:pseudorapidity}
    \end{equation}
    The advantage of the pseudorapidity is the Lorentz invariance of differences in $\eta{}$. Furthermore, for massless or ultra-relativistic particles $\eta$ itself becomes Lorentz invariant in good approximation.
\end{itemize}

\subsection{CMS Detector \label{LHCCMSCMSDet}}

\begin{figure}[Hb]
    \centering
    \includegraphics[width=0.7\textwidth]{Detector/Sketch_CMS}
    \caption[Artistic sketch of the CMS detector]{An artistic sketch of the CMS detector. Taken from~\citen{CMSPlots}. \label{plot:LHCCMSWholeCMS}}
\end{figure}

At interaction point five of the LHC the CMS detector is located. The cylindrically shaped detector with a length of 29\m{} and a diameter of 15\m{} is placed in a cavern 100\m{} underground. The total weight of the detector is around 14\,000\unit{t}. An artistic sketch of the whole detector is shown in Fig.~\ref{plot:LHCCMSWholeCMS}. It is indicated that the detector can be divided into a barrel part consisting of five rings and endcaps placed at both ends of the barrel. Additionally, the general installation of the sub-detectors is onion shaped. One section of the CMS detector with layers of all sub-detectors is displayed in Fig.~\ref{plot:LHCCMSOnionCMS}. The gap in the middle is filled by the solenoid magnet. Starting from the innermost point after the beam-pipe the sub-detectors are arranged in the following way: Pixel and strip tracker, electromagnetic calorimeter, hadronic calorimeter, magnet and muon chambers. These sub-detectors are working at different temperatures that are reached by using liquid helium in cooling pipes. The whole detector is described in great detail in~\cite{Chatrchyan:1129810}.

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.7\textwidth]{Detector/CMS_Onion}
  \caption[One section of the CMS detector with all layers]{One section of the CMS detector with all layers of the sub-detectors together with the beam pipe. The magnet is placed in the gap. Taken from~\citen{CMSPlots}. \label{plot:LHCCMSOnionCMS}}
\end{figure}

\subsubsection{Silicon Tracker}

The innermost part of the CMS detector is the tracking system. It has a cylindrical shape with a length of 5.8\m{} and a diameter of 2.5\m{}. Consequently, the acceptance of the tracker reaches a pseudorapidity of 2.5. The modules of the tracker are made of silicon. On the one hand, modules made of silicon can provide a very high granularity and a fast readout. This is needed since at its design parameters the LHC will collide two proton bunches every 25\ns{} with around 1000 created particles per event. Furthermore, silicon is expected to withstand conditions with such a high radiation for a relatively high lifetime. On the other hand, using silicon modules leads to a high amount of readout electronics and cooling devices. This increases the probability of photon conversions or nuclear interactions. Further information about which sensor technology has been chosen can be found elsewhere~\cite{Chatrchyan:1129810}. In total, about 200\ms{} of active silicon area is built into the CMS tracker making it the largest silicon tracker ever built.\\
As demonstrated in the sketches shown in Fig.~\ref{plot:LHCCMSTrackerCMS} the tracker can be further divided into a pixel and a strip detector. A schematic cross section through the CMS tracker can be seen in Fig.~\ref{plot:LHCCMSTrackerCrossCMS}. There, the position of the pixel and strip tracker is illustrated, too.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.45\textwidth]{Detector/CMS_Tracker}
    \includegraphics[width=0.45\textwidth]{Detector/CMS_PixelTracker}
    \caption[Sketches of the CMS tracker]{A sketch of the whole CMS silicon tracker (left hand plot) and a zoom to the pixel tracker and its enclosure only (right hand plot) as taken from~\citen{CMSPlots}. \label{plot:LHCCMSTrackerCMS}}
\end{figure}

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.8\textwidth]{Detector/Sketch_CMS_Crosssection}
    \caption[Schematic cross section of the CMS tracker]{A schematic cross section of the CMS tracker including the pixel and strip detector. Modules that are marked with double lines deliver stereo hits. Taken from~\citen{Chatrchyan:1129810}. \label{plot:LHCCMSTrackerCrossCMS}}
\end{figure}

\paragraph*{Pixel Tracker}
To deliver a good reconstruction resolution of the track impact parameter the cells of the pixel tracker need to have a very small size. In order to achieve this a size of $\text{100}\,\times\,\text{150}\,\mu\text{m}^{\text{2}}$ per pixel is chosen. As can be seen in Fig.~\ref{plot:LHCCMSTrackerCrossCMS} there are three barrel layers of the pixel detector with a length of 53\cm{} at radii of 4.4, 7.3 and 10.2 \cm{}. Furthermore, at the end planes of these cylinders two pixel disks are located at z values of $\pm{}34.5$ and $\pm{}46.5\,\text{cm}$. In the barrel region the cells are aligned in the $\phi{}$-$z$ plane and in the disks in the $x$-$y$ plane. One more special feature of the placement of the pixel disk modules is that they are tilted by 20\de{}. The reason for this is the charge-sharing that is due to the bending of the particles in the magnetic field.  With this arrangement three hits per track are expected in the pixel volume on average. In total, the pixel detector covers an area of about 1\ms{} and has 66 million pixels mounted on 1440 modules.


\paragraph*{Strip Tracker}
As already shown in Fig.~\ref{plot:LHCCMSTrackerCrossCMS} the strip tracker consists of several parts. In the central region two barrels, namely the tracker inner barrel (TIB) and the tracker outer barrel (TOB), are placed. On the end planes the tracker inner disks (TID) and the tracker endcaps (TEC) are installed. All these parts are equipped with several different silicon modules. For the two barrels rectangular sensors are chosen while there are 11 different wedge-shaped sensors for the TID and TEC. One further difference is the thickness. While close to the interaction region at the TIB, the TID and on the four inner rings of the TEC thin sensors with a thickness of 320\mum{} are used the other modules are 500\mum{} thick. These different thicknesses are chosen because of the particle flux and the resulting signal-to-noise ratio. Finally, another important difference between the modules is the width. They can have either 512 or 768 strips with a pitch of 80$-$120\mum{}. In general, the farther the sensors are away from the interaction region the thicker, the more strips and the larger strip pitch they have. Due to the strip design the modules are able to measure the impact point of the track with a high accuracy in one dimension only. To provide also two dimensional information about the impact point at some places two modules are paired together with an angular difference of 100\mrad{}.\\
In the central region the TIB consists of four cylinders with a length of 140\cm{} placed at radii of 255.0, 339.0, 418.5 and 498.0\mm{}. This tracker part is followed by the TOB that is the only tracker sub-detector that is fully equipped with thick sensors. It consists of six cylindrical layers with a length of 236\cm{}. The layers are placed at radii of 608, 692, 780, 868, 956 and 1080\mm{}. The modules are arranged in a way that the strips are parallel to the z direction. Hence the $\phi{}$ position of the hit can be measured with highest accuracy. For both, TIB and TOB, the two innermost layers are equipped with double-sided modules giving also information about the z position of the hits.\\
Next to the TIB the TID is placed. It consists of three disks at z positions of $\pm{}$80 to $\pm$90\cm{}. These disks are identical and assembled with three rings of modules spanning a radius from 200 to 500\mm{}. Due to this orientation again the $\phi{}$ position of the hit has the highest accuracy. The two innermost rings of each wheel are equipped with double-sided modules. In doing so, the radius of the position of the double-sided modules of TIB and TID are similar. Additionally, the radius of the hit from the beam axis can be measured at the double-sided modules. Lastly, the TEC consists of 9 endcaps at z positions from $\pm{}$124 to $\pm{}$ 280\cm{}. They cover a radius from 220 to 1135\mm{}. Depending on the z position the endcaps are equipped with four to seven rings of modules. The double-sided modules are again placed in a way that the distance to the beam axis is the same as for those in the TIB and TOB.

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.55\textwidth]{Detector/Tracker_RadiationLength}
    \caption[Material budget of the CMS tracker]{The stacked material budget of the CMS tracker in multiples of the radiation length as a function of the pseudorapidity. It is further broken down to the sub-detectors. Taken from~\citen{Chatrchyan:1129810}. \label{plot:LHCCMSTrackerRadiationLength}}
\end{figure}

In total, 15 148 strip detector modules are installed leading to 24\,244 channels from 9.3 million strips. In Fig.~\ref{plot:LHCCMSTrackerRadiationLength} the material budget in terms of radiation length is shown for the whole tracker and divided into the sub-detectors. As can be seen for the central region it is between 0.4 and 0.6 radiation lengths but for a pseudorapidity between 1 and 2 it rises up to 1.8. For electrons the radiation length is the typical length in which a high energetic electron loses its energy due to Bremsstrahlung down to 1/e. For photons it is defined as 7/9 of the mean free path for pair production of a high energetic photon. The consequence is that about $75\,\%$ of all high energetic photons convert within the tracker volume.\\
The resulting resolution of the position of a hit is on average between 10 and 50\mum{} \cite{CMS-PAPER-TRK-11-001}.

\subsubsection{Electromagnetic Calorimeter}

To measure the electromagnetic energy, a hermetic and homogeneous calorimeter made of more than 75\,000 lead tungstate crystals is placed right behind the tracker. It is again cylindrical with a length of about 630\cm{} and a diameter of 354\cm. The barrel part can be seen on the left hand plot in Fig.~\ref{plot:LHCCMSECalCMS} while a typical endcap of a calorimeter is shown in the right hand plot of Fig.~\ref{plot:LHCCMSHCalCMS}. The transition region from the barrel to the endcaps is at a pseudorapidity of around 1.5. The individual crystals are arranged in a way that all face the interaction point as shown in the right hand plot of Fig.~\ref{plot:LHCCMSECalCMS}. Lead tungstate is chosen because of its high density (8.28\gcmc{}), short radiation length in the order of 0.89\cm and its small Moli\`ere radius of 2.2\cm{}. The Moli\`ere radius is a characteristic constant of a material. A cylinder with this radius contains on average $90\,\%$ of the energy deposition of a electromagnetic shower. The crystals have the shape of a truncated pyramid with a cross section of 22 $\times{}$ 22\mms{} at the inner and 26 $\times{}$ 26\mms{} at the rear surface. The length of one crystals is 23\cm corresponding to 25.8 radiation lengths.

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.45\textwidth]{Detector/CMS_ECal}
  \includegraphics[width=0.45\textwidth]{Detector/CMS_ECal_Modules}
  \caption[Sketches of the electromagnetic calorimeter of CMS]{A sketch showing the barrel of the CMS electromagnetic calorimeter (left hand pot) and one slice of the modules (right hand side). Taken from~\citen{CMSPlots}. \label{plot:LHCCMSECalCMS}}
\end{figure}

\subsubsection{Hadronic Calorimeter}

The hadronic calorimeter is the last sub-detector that is placed inside of the magnet for the most parts. It is not only important for the measurement of hadronic jets but contributes also to the calculation of the missing energy. The general structure is illustrated in Fig.~\ref{plot:LHCCMSHCalCross}. There are four parts of the hadronic calorimeter.\\
The two sub-detectors inside the magnets, the hadron barrel (HB) and hadron endcaps (HE), are sampling calorimeters. This is because of the fixed amount of volume between the electromagnetic calorimeter and the magnet. Furthermore, the magnetic field produced by the solenoid restricts the material the hadronic calorimeter can be build from. A further requirement on the modules is a fast read out. Therefore, brass is chosen as the absorber material and plastic scintillator read out by hybrid photodiodes as the active medium. The barrel covers a radius region from 1.77 to 2.95\m{} up to a pseudorapidity of $\left|\eta{}\right| \leq{} 1.3$. The endcaps enlarge the pseudorapidity range to $\left|\eta{}\right| \leq{} 3$. While for the HB the granularity is always $\Delta{}\eta\,\times\,\Delta{}\phi{} = 0.087 \times{} 0.087$ in the HE the granularity changes to $\Delta{}\eta\,\times\,\Delta{}\phi{} \approx 0.17 \times{} 0.17$ for $\left|\eta{}\right| \geq{} 1.6$. These towers consists of 16 layers of scintillators and absorber starting and ending with a scintillator. A sketch of the HB and HE can be seen in Fig.~\ref{plot:LHCCMSHCalCMS}. In total the thickness of the inner calorimeters in terms of interaction length is about five for $\eta{}=0$ increasing to about ten for $\left|\eta{}\right|\approx{}3$.\\
Hence, in the central region the HB does not provide enough stopping power for high energetic jets. Therefore, behind the magnet the hadronic calorimeter is extended with a tail catcher named hadron outer (HO). Except for the innermost ring ($\left|z\right| \leq{} 1.343\,m$) it consist of one (two for the central region) layer(s) of plastic scintillator read out by hybrid photodiodes during the first run period. The granularity is the same as for the HB. The space available between the magnet and the first layer of the muon chamber is in the order of 4\cm{} that leads to about 1\cm{} for the detector layer. Unfortunately, this detector has not been used in the event reconstruction.
The fourth part of the hadronic calorimeter is the hadron forward (HF) detector. It is the detector component  covering the  highest $\eta{}$ range up to 5. It is a Cherenkov detector made of quartz fibers. These fibers are built from a 600\mum{} thick fused-silica core that is surrounded by a 30\mum{} thick polymer hard-cladding. For protection a 170\mum{} thick acrylate buffer is mounted. The HF itself is a cylinder with a radius of 130\cm{} at a distance of 11.2\m{} from the interaction point. The fibers are running parallel to the beam axis. The information of this detector is also used to calculate the luminosity.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.7\textwidth]{Detector/CMS_HCal_Cross}
    \caption[Cross section of the CMS hadronic calorimeter]{The cross section of one quarter of the CMS hadronic calorimeter showing the hadron barrel (HB), the hadron endcaps (HE), the hadron outer (HO) and the hadron forward (HF) detector. Dashed lines symbolize fixed values of the pseudorapidity. Taken from~\citen{Chatrchyan:1129810}. \label{plot:LHCCMSHCalCross}}
\end{figure}

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.45\textwidth]{Detector/CMS_HCal}
  \includegraphics[width=0.45\textwidth]{Detector/CMS_ECal_EndCap}
  \caption[Sketches of the hadronic calorimeter of CMS]{A sketch of the hadronic sample calorimeter of the CMS detector (left hand plot) and one of a typical endcap of the electromagnetic of hadronic calorimeter (right hand plot). Taken from~\citen{CMSPlots}. \label{plot:LHCCMSHCalCMS}}
\end{figure}

\subsubsection{Superconducting Magnet}

In Fig.~\ref{plot:LHCCMSMagnetCMS} a sketch of the superconducting magnet is shown. It has a length of 12.5\m{} and a diameter of 6\m{}. It is designed to reach an uniform axial 4\unit{T} field on the inside with an inductance of 14.2\unit{H} and a stored energy of 2.6\unit{GJ}. Together with its weight of 220 tonnes it reaches the best energy to mass ratio of all magnets used in particle physics. On the outside the field it returned through a yoke. This yoke alone has a weight of 10\,000\unit{t}. The magnet itself if made of Nb-Ti running at a Temperature of 4.6\K{}.

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.7\textwidth]{Detector/CMS_Magnet}
  \caption[Sketch of the solenoid magnet]{A sketch showing the solenoid magnet of the CMS detector and the beam pipe with a human for size comparison. Taken from~\citen{CMSPlots}. \label{plot:LHCCMSMagnetCMS}}
\end{figure}

\subsubsection{Muon Chambers}

The outermost sub-detectors are the muon chambers. As is already implied by the second letter of the abbreviation of the name of CMS detecting muons is one of the key purposes. In total an active area of about 25\,000\ms{} is used in the muon chambers. There are three different types of detectors used that can be seen in Fig.~\ref{plot:LHCCMSMuonChambersCMS}. In the barrel region up to a pseudorapidity of $\left|\eta{}\right| \leq{} 1.2$ drift tubes (DT) are used. In 250 drift chambers about 172\,000 sensitive wires are plugged. These wires have a length of 2.4\m{} measuring the hit position in the $r$-$\phi{}$ plane. The DT are 2.1\cm{} thick and use a gas mixture of $85\,\%$ Ar and $15\,\%$ $\text{CO}_{\text{2}}$. Their main purpose is the tracking of the muons but they are also used for triggering. In the forward region cathode strip chambers (CSC) are used. These are multi-wire proportional chambers with six anode wire planes interleaved among seven cathode panels. The size of such a CSC can be up to $3.4\,\times{}\,1.5\ms{}$. Furthermore, resistive plate chambers (RPC) are used. These are gaseous parallel-plate detectors. Their biggest advantage is the very good time resolution that enables a good identification of the bunch crossing. In the barrel region six layers of these RPC's are embedded in the yoke of magnet. During the first run period of the LHC three RPC layers are installed in the endcap region covering up to $\left|\eta{}\right| = 1.6$.

\begin{figure}[Htb]
  \centering
  \includegraphics[width=0.7\textwidth]{Detector/CMS_MuonChambers}
  \caption[Sketch of the muon chambers of CMS]{A sketch of the muon chambers of the CMS detector. In the barrel region the drift tubes (DT) together with the resistive plate chambers (RPC) are placed between the different layers of the yoke of the magnet. In the endcap region perpendicular to the beam pipe the cathode strip chambers (CSC) and again RPC's are mounted. Taken from~\citen{CMSPlots}. \label{plot:LHCCMSMuonChambersCMS}}
\end{figure}


\subsection{Event Reconstruction \label{LHCCMSEventReco}}

\subsubsection{Trigger}

At its design luminosity the LHC collides proton bunches at a frequency of 40\unit{MHz}. During the first run period it has been at 20\unit{MHz}. Considering now the millions of channels that are read out during the reconstruction of one event one can appreciate that it is impossible to reconstruct every event. Therefore, a drastic event reduction is needed. This tasks is performed by a two stage trigger. While the first so-called \Lone{} (L1) trigger takes only the information from the calorimeters and the muon chambers into account, the following high-level trigger (HLT) does also a rough reconstruction of the whole event using the whole detector. The L1 trigger runs online and its design aim is to reduce the incoming 20\unit{MHz} to an outgoing rate of $30-100\unit{kHz}$. The data rate after the L1 trigger is in the order of 100\GBytes{}. The HLT is then run offline. More dedicated information about the two levels of the trigger and the following data acquisition can be found in~\citen{Chatrchyan:1129810} and~\citen{Cittolin:578006}.

\subsubsection{Particle and Vertex Reconstruction \label{sec:LHCCMSPaVR}}

The key towards a complete and accurate reconstruction of the whole event at the CMS experiment is the \textit{particle-flow} algorithm. In it, all stable particles are reconstructed and identified using a thorough combination of the information from all sub-detectors. The list of particles created is then used to build up jets and calculate the missing transverse energy. A very detailed description of the algorithm can be found in~\citen{CMS-PAS-PFT-09-001}. This thesis will only focus on some aspects that are very important for the following work that are the reconstruction of tracks from charged particles in the tracker and the reconstruction of primary and secondary vertices.

\paragraph*{Iterative Tracking}

\begin{figure}[Ht]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/TrackRes_dz_Vs_Pt}
    \caption[Track resolution \vs pseudorapidity for different bins of transverse momentum]{The distribution of the track resolution of the transverse impact parameter $d_{z}$ as a function of the transverse momenta for different bins of pseudorapidity. The tracks are divided into three regions of pseudorapidity, the barrel region $\left[0., 0.9\right]$, the transition region $\left(0.9, 1.4\right]$ and the endcap region $\left(1.4, 2.5\right]$. \label{plot:IntroTrackRes}}
\end{figure}

At CMS the reconstruction of tracks from charged particles happens in several iterations. Starting with those tracks that are easiest to reconstruct for the following iterations all used hits are removed from the initial hit collection. In this process, during the first iterations the seeds for the tracks are taken from those parts of the tracker that deliver a good accuracy like the pixel detector or the stereo modules of the strip tracker. In doing so, the combinatorical complexity is reduced allowing to reconstruct more difficult tracks in the following iterations. In each iteration three steps are executed. First, a collection of possible seeds is created. Depending on the iteration only some of the parts of the tracker are used. Based on these seeds a Kalman Filter~\cite{Fruhwirth:1987fm} is run building a trajectory of the possible track. Along this trajectory it is looked for more fitting hits. Finally, based on all these hits the track is fitted using again the Kalman filter and smoother. More information about the seeding and fitting of the tracks can be found in~\citen{CMS-PAPER-TRK-11-001}. Having executed this reconstruction tracks with a transverse momentum down to 0.1\GeV{} can be reconstructed based on at least 5 hits. During the reconstruction electrons need special treatment since they undergo Bremsstrahlung and lose a large amount of their energy. This loss is non-Gaussian. Since the Kalman filter is optimal only when all variables have Gaussian uncertainties it does not work very well for electrons. In order to account for this two methods are developed using the information from the ECal as additional seeds (look at~\citen{CMS-PAS-PFT-10-003} and~\citen{CMS-PAS-EGM-10-004} for more information). To include the non-Gaussian uncertainty the Kalman filter is modified to the Gaussian Sum Filter (GSF) as is described in~\citen{Adam:815410}. Having executed the tracking a total efficiency above $90\,\%$ can be reached at a misidentification rate in the order of $10\,\%$. \\
One important outcome of the track reconstruction is the resolution of the vertex of the track, especially the resolution of the z position. As will be explained later the region where the tracks come from is much larger along the $z$ axis than in the other two dimensions. Hence, a good precision of the z position of the track's origin is necessary. The resolution is estimated based on simulated events and is calculated as follows. For every reconstructed track the best matching simulated track is taken. This best match is found by comparing the number of shared hits. A minimum number of shared hits is needed. From both tracks the z value of the position of closest approach to the interaction region is taken. The distance between these two values is then stored in a histogram. After this is done for all analyzed tracks a Gaussian is fitted to this histogram. Finally, to obtain the resolution of the z position of the tracks vertex the standard deviation of this Gaussian is divided by $\sqrt{2}$.  As shown in Fig.~\ref{plot:IntroTrackRes} the averaged resolution of the z position of the reconstructed track lies between 30\mum and can go up to some millimeter for high $\left|\eta\right|$ and low \pt{}.

\paragraph*{Primary Vertex Reconstruction}

Another important collection are the reconstructed primary vertices. These are produced by clustering a subset of the reconstructed tracks into sets of tracks that are coming from nearly the same position. These tracks have to fulfill certain quality selections and have its origin close to the interaction region. The most important feature for the work presented here is the so-called track weight. This weight is calculated after the fit is finished and stands for the compatibility between the track and the fitted vertex. It is greater than zero for those tracks only that are used during the fit of the respective vertex. The closer the value gets to one the more compatible the track is with the vertex. As said above only a subset of the reconstructed tracks is used for the production of the primary vertices. Figure~\ref{plot:IntroTrackWeight} illustrates that about $60\%$ of all reconstructed tracks have a track weight at any vertex.  More information about the technique of the vertex fit can be found elsewhere~\cite{CMS-PAPER-TRK-11-001}.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.45\textwidth]{Intro/VertexNum_Vs_Ntrks}
    \includegraphics[width=0.45\textwidth]{Intro/TrackWeightCheck}
    \caption[Distribution of the number of tracks used to fit the primary vertices and fraction of reconstructed tracks that have a track weight at any primary vertex]{The distribution of the number of tracks used for fitting a particular vertex (left hand side) and the fraction of reconstructed tracks that have a track weight greater than 0 at the chosen signal vertex, at any primary vertex or at no vertex at all as a function of the pseudorapidity (right hand side). \label{plot:IntroTrackWeight}}
\end{figure}

As shown in Section~\ref{sec:IntroLumiPPI} in one bunch crossing on average 30 proton-proton interactions are expected if the LHC runs at its maximum in the first run period. The space in that all these collisions happen is the so-called beam spot. The shape of the beam spot can be described as a cylinder lying centrally along the $z$ axis. This cylinder has a diameter of about 120\mum and a total length of about 30\cm. Therefore, the biggest separation of the primary vertices is expected to be along the $z$ axis compared to the other axes. The probability for a collision to be at a certain position z is shown in Fig.~\ref{plot:IntroVertexPos}. The shape of the probability can be well-described by a Gaussian with a width of about 5\cm.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/VertexNum_Vs_Z}
    \caption[Vertex distribution along z]{The distribution for the reconstructed primary vertices along the $z$ axis for the last run period in 2012 (integral normalized to unity). \label{plot:IntroVertexPos}}
\end{figure}

The mean separation of the primary vertices in one bunch crossing is therefore strongly dependent on the number of collisions. For the data in Fig.~\ref{plot:IntroVertexSep}, the mean separation is shown as a function of the number of reconstructed vertices of the bunch crossing. The separation is defined as the distance of one primary vertex to the next one. For bunch crossings with more than 30 reconstructed vertices the mean separation becomes less than 5\mm. The same holds for an instantaneous luminosity of greater than 6\hertzpernbarn. A more detailed look of the primary vertex separation can be found in Fig.~\ref{plot:IntroVertexSep2D}. As it can be seen the separation of the primary vertices can go down below 1\mm in the central region.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.45\textwidth]{Intro/VertexSep_Vs_Npu}
    \includegraphics[width=0.45\textwidth]{Intro/VertexSep_Vs_InstLumi}
    \caption[Mean vertex separation \vs number of reconstructed vertices and \vs instantaneous luminosity]{The distribution of the mean separation of the primary vertices \vs the number of reconstructed vertices (left hand side) and \vs the instantaneous luminosity for one run of the last run period in 2012. \label{plot:IntroVertexSep}}
\end{figure}

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.45\textwidth]{Intro/VertexSep_Vs_Npu_Vs_Z}
    \includegraphics[width=0.45\textwidth]{Intro/VertexNum_Vs_Z_Vs_Sep}
    \caption[Vertex separation \vs number of reconstructed vertices and \vs z position of the vertex. Number of signal vertices \vs z position and separation for events with 20 underlying pileup events]{The distribution of the averaged separation of the signal vertex \vs the number of reconstructed vertices and the z position (left hand side) and the number of signal vertices \vs the z position and separation for events with 20 underlying pileup events for one run of the last run period in 2012. \label{plot:IntroVertexSep2D}}
\end{figure}

To estimate the resolution of the primary vertex reconstruction the "split method" is applied on data from one run at the end of the first run period in 2012. A more detailed description of this method can be found in reference~\citen{CMS-PAPER-TRK-11-001}. First, all tracks from a certain vertex are split equally into two different sets. In this process, one tries to ensure that both track sets have, on average, the same kinematic properties. Based on these two sets two new vertices are fitted independently using the adaptive vertex fitter~\cite{CMS-PAPER-TRK-11-001}. The distance of the position of these two vertices is then stored. After applying this procedure to all primary vertices a Gaussian is fitted to the distribution of that distance. To obtain the resolution of the primary vertices the standard deviation of the Gaussian is divided by $\sqrt{2}$. In Fig.~\ref{plot:IntroVertexRes} the primary vertex resolution in z is shown. The resolution depends strongly on the number of tracks that are used to fit the primary vertex. The typical range of this resolution lies between 200\mum for about 10 tracks and around 40\mum for more than 60 tracks.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/VertexResolution_Vs_nTrks}
    \caption[Vertex resolution \vs number of used tracks]{The distribution of the resolution in z of the primary vertices \vs the number of tracks that are used to fit the primary vertex for one run of the last run period in 2012. \label{plot:IntroVertexRes}}
\end{figure}

Thus, the complete picture of the distribution of the primary vertices is that the typical separation lies in the millimeter region while the resolution is 2 orders of magnitude smaller. On the other hand the resolution of the track reconstruction lies somewhere in between.\\
Having fitted all primary vertices, the $\pt^{2}$ of all tracks that are used to fit a particular vertex is summed up. To select the physically most interesting interactions the vertex with the highest $\pt^{2}$ sum is typically chosen. In order to account for misreconstructed track momenta the uncertainty in the transverse momentum is first subtracted from the \pt and only if the reduced \pt is still greater than zero it is squared and added to the sum. Figure~\ref{plot:IntroSigVertexProb} shows the probability that the chosen primary vertex is the closest reconstructed vertex to the simulated signal interaction. For events with more than 40 underlying pileup events the efficiency can drop below $90\,{}\%{}$.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/FirstVertexCheck_Vs_Npu}
    \caption[Probability to define the correct vertex as signal]{The percentage for events in that the correct primary vertex is defined as the signal vertex as a function of number of reconstructed vertices. \label{plot:IntroSigVertexProb}}
\end{figure}

\paragraph*{Secondary Vertex Reconstruction}

One more ingredient to the presented work are the reconstructed secondary vertices. Important to this work are namely the photon conversions, the $\text{V}^{\text{0}}$ decays standing for \PKzS{} and \PgL{}, secondary vertices coming from nuclear interactions and another producer tuned to the fit of vertices coming from the decay of a B hadron. \\
A detailed description of the reconstruction of photon conversions can be found in~\cite{GiordanoConversion} or~\cite{CMS-PAS-EGM-10-005}. The basic principle is to find pairs of oppositely charged particles that have vertices close to each other and tracks that are parallel at that point. Additionally, the invariant mass of the pair has to be close to zero. Based on these two tracks a vertex is fitted. \\
The reconstruction of $\text{V}^{\text{0}}$ decays is similar. It is described in~\citen{v0paper}. It aims at finding secondary vertices as for example coming from $\PKzS{} \rightarrow{} \Pgpm{}\Pgpp{}$ and $\PgL{} \rightarrow{} p\Pgpp{}$. Thus, it requires the presence of two oppositely charged particles having their vertices at a similar position. Furthermore, the invariant mass of the pair has to be within a certain window around the nominal \PKzS{} (\PgL{}) mass. \\
The reconstruction of nuclear interactions is described in~\citen{CMS-PAS-TRK-10-001}. It is a much more general approach trying to link all pairs of tracks whose distance at the closest approach is small enough. Based on these pairs several secondary vertices are fitted. If the invariant mass of the pair matches to a photon or a $\text{V}^{\text{0}}$ the secondary vertex is removed from the list. \\
The last producer of secondary vertices, namely the inclusive vertex finder, is established to reconstruct the vertex of decays of B hadrons that mostly comes along with jets. A description can be found in~\citen{ivfPaper}.


\subsection{Reconstructed Proton-Proton Interactions}

The distribution of the number of reconstructed proton-proton interactions per bunch crossing is shown in Fig.~\ref{plot:IntroPileupDistr}. As illustrated, at CMS the mean of the number of proton-proton interactions for this run period was 21. Such a period covers all proton fills (run) of the LHC that are done with the same properties. That means on average about 20 soft interactions happen in an event with one hard interaction. The tail reaches up to 40 additional interactions. Comparing this to the expected number of 30 as calculated in Section~\ref{sec:IntroLumiPPI} a good agreement can be seen. The observed value is of course lower since the accelerator did not always run on its maximum. As explained earlier, the additional interactions are not of phyical interest. In contrast, they can have a severe influence on the performance of the reconstruction of the hard collisions (so-called signal process).

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.55\textwidth]{Intro/pileup_pp_2012}
    \caption[Number of proton-proton collisions]{The distribution of the number of proton-proton collisions calculated based on Fig.~\ref{plot:IntroInstLumi}. Taken from reference~\citen{CMS-Lumi-Public-Webpage}. \label{plot:IntroPileupDistr}}
\end{figure}

To illustrate the influence pileup can have, Fig.~\ref{plot:IntroOccuTracker} is shown. Both pictures display the occupancy of the CMS tracker for a simulated \ttbar event with 20 additional pileup events. The difference is that on the left hand picture only the tracks coming from the signal vertex are shown while on the picture on the right hand side all tracks are displayed. Here, only tracks from charged particles are shown since neutral particles do not leave hits in the tracker material. It is imaginable that these additional tracks affect the reconstruction of objects like jets or the missing transverse energy of the signal process.

\begin{figure}[Htb]
    \centering
    \includegraphics[width=0.45\textwidth]{Intro/tracker_withoutPU}
    \includegraphics[width=0.45\textwidth]{Intro/tracker_withPU}
    \caption[Occupancy of the tracker with and without pileup]{Both pictures show the occupancy of the CMS tracker in a \ttbar event. On the left hand side without pileup and on the right hand side with 20 underlying pileup interactions. Here, all tracks are shown that leave at least three hits in the tracker material, have a \pt greater than 1\GeV and a pseudorapidity of $\left|\eta\right|\leq2.4$. \label{plot:IntroOccuTracker}}
\end{figure}

\subsubsection{Current Pileup Subtraction Techniques \label{sec:IntroCurPST}}

First, it should be mentioned that the association of tracks to primary vertices can only be done for charged particles that leave hits in the tracker. For neutral particles it is more or less impossible to obtain a sufficient resolution on the momentum due to the much poorer spacial resolution of the calorimeter. In order to subtract tracks coming from pileup vertices, two different approaches are developed. Both techniques take advantage of the track weight that is stored in each vertex as explained in Section~\ref{sec:LHCCMSPaVR}. Possible problems or sources of errors are that both techniques only divide the reconstructed vertices into one signal vertex and one group containing all pileup vertices. For the latter ones no individual association is done. Therefore, both approaches strongly rely on the correct identification of the signal vertex that is explained above. Additionally, the clustering of the tracks to vertices can be faulty. \\
Another analogy is that both approaches are executed after the so-called \textit{particle-flow} identification is applied. This makes it possible that only for charged hadrons  the check for the track weight is done.  Only if they have a track weight at one of the pileup vertices they get subtracted. The difference between these two approaches manifests itself in the treatment of the charged hadrons that do not have a track weight at any primary vertex.

\begin{itemize}
    \item{Jet/MET approach:} In this approach, all charged hadrons that have no track weight at any primary vertex are treated as coming from the signal one. In doing so, the vertex with the highest $\pt{}^{2}$-sum is overvalued because about $40\%$ of all reconstructed charged hadrons are treated as signal always.
    \item{Muon/Egamma approach:} In this approach, charged hadrons that have no track weight at any primary vertex are assigned to the closest vertex in z. This approach takes advantage of the fact that the largest separation of the primary vertices is along the $z$ axis.
\end{itemize}

All other particles are treated as signal, first. In following filters for muons and electrons a criterion is applied to the distance of the track to the signal vertex. In doing so, pileup subtraction is executed for charged hadrons, muons and electrons. Hence, the new approach will be compared to the outcome of these associations and filters.

\subsubsection{Basic Ideas for a New Approach}

In order to reach a better performance in assigning tracks to primary vertices, a more individual search for the best matching vertex needs to be performed. As mentioned above no association to a particular pileup vertex takes place until now. Hence, afterwards it is impossible to obtain the tracks coming from one specific pileup vertex. To provide the possibility to obtain the track assigned to any primary vertex an \textit{Association Map} is created. In this map for any primary vertex it is possible to get a set of tracks together with a number indicating the quality of this association. In an additional step, it is possible to obtain only those tracks assigned to the signal vertex. Thus, tracks considered as coming from pileup vertices are subtracted from the initial track collection. The goal for this new approach is to reach a negligible dependency on the number of pileup interactions. Achieving this would allow to maintain the same performance of the reconstruction even for future analyses.

